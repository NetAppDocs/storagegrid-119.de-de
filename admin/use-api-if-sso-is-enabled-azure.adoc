---
permalink: admin/use-api-if-sso-is-enabled-azure.html 
sidebar: sidebar 
keywords: how to access storagegrid API if SSO is enabled with Azure 
summary: 'Wenn Sie Single Sign-On (SSO) konfiguriert und aktiviert haben und Azure als SSO-Anbieter verwenden, können Sie mithilfe von zwei Beispielskripten ein Authentifizierungstoken abrufen, das für die Grid Management API oder die Tenant Management API gültig ist.' 
---
= Verwenden Sie die API, wenn Single Sign-On aktiviert ist (Azure).
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Wenn Sielink:../admin/configuring-sso.html["Single Sign-On (SSO) konfiguriert und aktiviert"] und Sie Azure als SSO-Anbieter verwenden, können Sie mithilfe von zwei Beispielskripten ein Authentifizierungstoken erhalten, das für die Grid Management API oder die Tenant Management API gültig ist.



== Sign in , wenn Azure Single Sign-On aktiviert ist.

Diese Anweisungen gelten, wenn Sie Azure als SSO-Identitätsanbieter verwenden.

.Bevor Sie beginnen
* Sie kennen die SSO-E-Mail-Adresse und das Kennwort für einen Verbundbenutzer, der zu einer StorageGRID Benutzergruppe gehört.
* Wenn Sie auf die Tenant Management API zugreifen möchten, kennen Sie die Mandantenkonto-ID.


.Informationen zu diesem Vorgang
Um ein Authentifizierungstoken zu erhalten, können Sie die folgenden Beispielskripte verwenden:

* Der `storagegrid-ssoauth-azure.py` Python-Skript
* Der `storagegrid-ssoauth-azure.js` Node.js-Skript


Beide Skripte befinden sich im StorageGRID Installationsverzeichnis(`./rpms` für Red Hat Enterprise Linux, `./debs` für Ubuntu oder Debian und `./vsphere` für VMware).

Informationen zum Schreiben Ihrer eigenen API-Integration mit Azure finden Sie im `storagegrid-ssoauth-azure.py` Skript.  Das Python-Skript sendet zwei Anfragen direkt an StorageGRID (zuerst, um die SAML-Anforderung abzurufen, und später, um das Autorisierungstoken abzurufen) und ruft außerdem das Node.js-Skript auf, um mit Azure zu interagieren und die SSO-Vorgänge auszuführen.

SSO-Vorgänge können mithilfe einer Reihe von API-Anfragen ausgeführt werden, dies ist jedoch nicht ganz einfach. Das Puppeteer Node.js-Modul wird zum Scrapen der Azure SSO-Schnittstelle verwendet.

Wenn Sie ein Problem mit der URL-Kodierung haben, wird möglicherweise folgender Fehler angezeigt: `Unsupported SAML version` .

.Schritte
. Installieren Sie die erforderlichen Abhängigkeiten wie folgt:
+
.. Installieren Sie Node.js (siehe https://nodejs.org/en/download/["https://nodejs.org/en/download/"^] ).
.. Installieren Sie die erforderlichen Node.js-Module (Puppeteer und jsdom):
+
`npm install -g <module>`



. Übergeben Sie das Python-Skript an den Python-Interpreter, um das Skript auszuführen.
+
Das Python-Skript ruft dann das entsprechende Node.js-Skript auf, um die Azure SSO-Interaktionen durchzuführen.

. Geben Sie bei entsprechender Aufforderung Werte für die folgenden Argumente ein (oder übergeben Sie sie mithilfe von Parametern):
+
** Die SSO-E-Mail-Adresse, die zur Anmeldung bei Azure verwendet wird
** Die Adresse für StorageGRID
** Die Mandantenkonto-ID, wenn Sie auf die Mandantenverwaltungs-API zugreifen möchten


. Geben Sie bei der entsprechenden Aufforderung das Kennwort ein und seien Sie bereit, Azure bei Bedarf eine MFA-Autorisierung bereitzustellen.
+
image::../media/sso_api_password_mfa.png[Aufforderung zur Eingabe von Passwort und MFA]

+

NOTE: Das Skript geht davon aus, dass MFA mit Microsoft Authenticator durchgeführt wird.  Möglicherweise müssen Sie das Skript ändern, um andere Formen der MFA zu unterstützen (z. B. die Eingabe eines in einer Textnachricht empfangenen Codes).

+
Das StorageGRID Autorisierungstoken wird in der Ausgabe bereitgestellt.  Sie können das Token jetzt für andere Anfragen verwenden, ähnlich wie Sie die API verwenden würden, wenn SSO nicht verwendet würde.


